<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name = "description" content="Рефакторинга много не бывает">
  <meta name = "keywords" content="Рефакторинг,Разработка">
  <meta name = "author" content="Ramil Vildanov">
  <meta name = "viewport" content="width=device-width, initial-scale=1.0">
<title>RTFN</title>
<link rel="shortcut icon" type="image/x-icon" href="https://rvildanov93.github.io/img/other/title-image.png"/>  
<link rel="stylesheet" href="https://rvildanov93.github.io/css/main.css">
</head>
<body>
<!--Site name-->
<div class="header">
  <h1>RTFN</h1>
</div>
<!--Top navbar-->
<div class="topnav">
  <a href="https://rvildanov93.github.io/index.html">Главная</a>
  <a href="Контакты.html">Контакты</a>
  <a href="#">Проекты</a>
  <a class="about" href="О сайте.html">О сайте</a>
</div>
<!--Main part (left column)-->
<div class="row">
  <div class="leftcolumn">
<!--Article header-->
      <div class="card">
      <h5><time datetime="2019-01-27" pubdate>27 января 2019</time> &#x2223; Перевод</h5>
      <h1>Рефакторинга много не бывает</h1>
      <h5><a href="https://www.freecodecamp.org/news/refactoring-oops-ive-been-doing-it-backwards-55eed503ccd0/">Автор оригинала: Justin Fuller</a></h5>
<!--Article body-->     
<img src="https://rvildanov93.github.io/img/Рефакторинга%20много%20не%20бывает/refactoring-tizer.jpg"  height="200" width="1072.4" alt="refactoring">
<p>Я очень завишу от рефакторинга, и не боюсь признать это, но есть только одна проблема: я всегда делал это задом наперед. Видите ли, то, что я делал, можно было бы точнее описать как преждевременную абстракцию кода.</p>
<p>Мы все знаем о рефакторинге. Если вы прочитали хотя бы одну книгу по программированию или много времени сидите на Medium, то наверняка слышали об этом. Это важная концепция, которая делает код понятным, поддерживаемым и расширяемым. Так почему рефакторинг не оправдал моих надежд?</p>
<p>Когда я писал свою последнюю библиотеку, мне потребовалось время, чтобы подумать об эволюции моего кода. Я понял, что до того, как у меня был полностью работающий продукт, и до того, как у меня были идеальные результаты моих модульных тестов, я преобразовал свой код в интерфейс, хотя не был даже уверен в том, понадобится-ли он мне. Я переместил код, сделал его расширяемым, многоразовым, но почему? Этот код даст мне окончательный результат, который мне нужен? Этого я еще не знал. В конце концов, все получилось, но был ли мой код более сложным, чем нужно? Думаю, что да.</p>
<h2>Главенство принципов над целью</h2>
<p>Вы слышали о <a href="https://en.wikipedia.org/wiki/SOLID">SOLID-принципах</a>? Я стараюсь внимательно следить за ними. Каждая функция, которую я пишу, нацелена на <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">принцип единственной ответственности</a>. Мои классы стремятся быть <a href="https://en.wikipedia.org/wiki/Open–closed_principle">открытыми для расширения</a>, игнорируя модификации. Я также стараюсь не зависеть напрямую от слишком многих вещей, поэтому вместо этого я принимаю <a href = "https://en.wikipedia.org/wiki/Dependency_inversion_principle">зависимости в качестве аргументов</a> в функциях и классах.</p>
<p>Является ли это рецептом хорошего кода? Думаю, что да. Проблема возникает тогда, когда мой код сосредоточен на том, чтобы соответствовать SOLID-принципам, а не выполнять то, для чего он был создан. Проблема возникает, когда я ставлю принципы превыше цели.</p>
<p>Помните мое размышление в самом начале? Это напомнило мне мантру: <a href="http://wiki.c2.com/?MakeItWorkMakeItRightMakeItFast">«Заставь это работать, сделай это правильно, сделай это быстро»</a>. Я понял, что не следовал этому порядку. Я делал все правильно, быстро, а потом делал так, чтобы это работало!</p>
<h2>Заставьте это работать</h2>
<p>Когда я начал писать больше статей на Medium, стало ясно, что хороший стиль письма не приходит вот так сразу. Сначала я должен изложить все свои мысли на странице. Я должен увидеть, куда эти мысли меня приведут. Затем я должен превратить их в некую полусвязную и неразборчивую версию того, что только что выплеснулось. То же самое может случиться и с кодом.</p>
<p>Вначале не стоит слишком беспокоиться о присвоении имен, о единоличной ответственности или расширении - вы решите эту проблему, как только ваша функция заработает. Вы не собираетесь разом писать все приложение, только этот один маленький кусочек.</p>
<img src="https://rvildanov93.github.io/img/Рефакторинга%20много%20не%20бывает/2.jpeg" height="550" width="400">
<p>Как только вы получили результат, который искали (у вас есть модульные тесты, чтобы доказать, что код верен) начните рефакторинг, но не заходите слишком далеко! Придерживайтесь стратегий рефакторинга, которые относятся к категории правильного именования, функциям, выполняющим только одну задачу, и избеганию изменений; не начинайте сразу создавать расширяемые или повторно используемые классы, пока не определите повторяющийся шаблон.</p>
<p>Подумайте об отсрочке рефакторинга с шаблонами, которые полезны только в определенных сценариях. Вы захотите сохранить их, до тех пор, пока у вас не будет причины.</p>
<h2>Имейте причину для рефакторинга</h2>
<p>Наличие SOLID-кода не является причиной. Наличие функционального или чистого кода также не является причиной. Почему мы делаем наш код расширяемым? Таким образом, подобная, но не совсем одинаковая функциональность может отойти от базовой логики. Почему мы инвертируем зависимости? Для того, чтобы бизнес-логика могла использоваться несколькими реализациями.</p>
<p>Надеюсь, вы понимаете, куда я веду. Некоторый рефакторинг необходим сам по себе. Например, рефакторинг имени переменной, чтобы стать более точным, всегда будет иметь смысл. Его заслуга неотъемлема. Перевод функции в чистое состояние обычно имеет смысл, т.к. побочные эффекты могут вызвать непредвиденные проблемы. Все это причины.</p>
<p>«Считается, что лучше всего использовать инверсию зависимостей» - это не причина. «Хороший код - расширяемый код» - это тоже не причина. Что если у меня есть только пара неизменяемых зависимостей? Мне все еще нужна инверсия зависимостей? Пока что нет. Что если ничего не нужно для расширения моего кода, и я вообще не планирую этого делать? Должен ли я усложнять мой код, чтобы просто отметить этот флажок? Нет!<p>
<p>Посмотрите на следующий пример:</p>
<code>
<p>// not extensible
<p>function getUser() {
<p>&nbsp;&nbsp;return {
<p>&nbsp;&nbsp;&nbsp;&nbsp;name: 'Justin',
<p>&nbsp;&nbsp;&nbsp;&nbsp;email: 'justinfuller@email.com'
<p>&nbsp;&nbsp;}
<p>}
<p>// Extensible
<br>
<p>class User {
<p>&nbsp;&nbsp;constructor(options = {}) {
<p>&nbsp;&nbsp;&nbsp;&nbsp;this.userData = options
<p>&nbsp;&nbsp;}
<p>&nbsp;&nbsp;get() {
<p>&nbsp;&nbsp;&nbsp;&nbsp;return this.userData
<p>&nbsp;&nbsp;}
<br>
<p>&nbsp;&nbsp;set(key, value) {
<br>
<p>&nbsp;&nbsp;&nbsp;&nbsp;this.userData[key] = value
<p>&nbsp;&nbsp;}
<p>}</code>
<p>Что вы предпочитаете? Что обычно пишете в первую очередь? Конечно, класс <code>User</code> гораздо более расширяем, потому что он может обрабатывать не только имя и электронную почту. Он также может быть расширен дочерним классом, может быть <code>SuperUser</code>, который будет иметь гораздо больше методов, но все еще использует классические методы <code>get()</code> и <code>set()</code>.</p>
<p>Тем не менее класс <code>User</code> может быть излишним, и ваш код может стать гораздо сложнее, чем это когда-нибудь может понадобиться. Мой совет - придерживайтесь простейшего шаблона.</p>
<h2>Порядок сложности</h2>
<p>А теперь, с вашего позволения, я собираюсь кое-что придумать. Я называю это порядком сложности, и это помогает мне, когда я принимаю решения о рефакторинге. Вот как это выглядит:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const">Постоянная переменная (Constant Variable)</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let">Изменяемая переменная (Mutable Variable)</a></li>
<li>Коллекция (Объект, Массив)</li>
<li>Функция</li>
<li>Функция с <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">замыканием (Closure)</a></li>
<li>Factory (функция, которая возвращает коллекцию)</li>
<li>Класс</li>
</ul>
<p>Всякий раз, когда я решаю, как организовать функциональность, я обращаюсь к этому списку. Я не буду выбирать снова, пока это просто не начнет работать. Иногда производительность влияет на этот выбор, но не так часто. Обычно я помещаю что-то в объект вместо простой константной переменной. Этот список держит меня под контролем и предохраняет от преждевременного рефакторинга.</p>
<h2>Баланс</h2>
<p>Недавно я слышал, что если вы скажете на собрании, «на самом деле все сводится к поиску правильного баланса», все кивнут головой на ваш бессмысленный комментарий, как будто вы сказали что-то умное. Однако, я думаю, что баланс все таки важен. Как программисты, мы должны сбалансировать качество кода, производительность и удобство обслуживания с необходимостью добиваться цели. Мы должны быть бдительными и следить за тем, чтобы обе потребности оставались на своем месте. Наш код не может быть обслуживаемым, если он не будет правильно работать. С другой стороны, трудно заставить плохой код работать правильно.</p>
<p>В следующий раз, когда захотите провести рефакторинг своего кода, подумайте, а стоит ли?<p>
</div>
  </div>
<!--Right columns (sticky)-->
 <div class="rightcolumn sticky">
  <!--Popular articles-->
    <div class="popular">
      <h3>Популярное</h3>      
      <p><strong><a href="https://rvildanov93.github.io/pages/Li-Fi Будущее интернета.html">Li-Fi: Будущее интернета</a></strong></p>
      <p><strong><a href="https://rvildanov93.github.io/pages/Очередная статья о том, как выбрать смартфон.html">Очередная статья о том, как выбрать смартфон</a></strong></p>
      <p><strong><a href="https://rvildanov93.github.io/pages/Интернет вещей которые плачут по хорошему UI UX.html">Интернет вещей… которые плачут по хорошему UI / UX</a></strong></p>
    </div>
<!--Social nedia block-->
    <div class="card">
      <h3>Подписывайся</h3>
      <a href="https://twitter.com/rvildanov93"><img class = "social" src="https://rvildanov93.github.io/img/social%20media%20icons/Twitter.png" height="50" width="50" alt="Twitter logo"></a>
      <a href="https://github.com/rvildanov93"><img class = "social" src="https://rvildanov93.github.io/img/social%20media%20icons/Github.png" height="50"width = "50" alt="GitHub logo"></a>
      <a href="https://vk.com/rvildanov93"><img class = "social" src="https://rvildanov93.github.io/img/social%20media%20icons/Vk.png" height="50"width = "50" alt="Vkontakte logo"></a>
    </div>
  </div>
</div>
<!--Footer/Copyright bottom block-->
<div class="footer">
  <h6>Copyright &#169; 2019 by Ramil Vildanov</h6>
  <h6>All Rights Reserved</h6>
</div>
</body>
</html>